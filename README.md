# Cathedral-and-the-Bazaar-of-Software-Vulnerabilities

This repository provides the datasets used in our paper for analyzing entry-level and group-level inconsistencies between CNAs and the NVD.  
**Note**: The private CNA dataset (referred to as *Company X*) used in our experiments and analysis is not included in this repository. The scripts provided below operate only on public CNA data obtained from VulnCheck.

---

## Usage

- **Python version**: 3.10.9  
- Make sure the following Python packages are installed: `pandas`, `numpy`, `seaborn`, `matplotlib`.

---

## Folder Contents

### ðŸ“‚ Original Dataset

As the files `vulCheck_v31.csv`, `vulCheck_v31_Cleaned.csv`, and `vulCheck_v31_Cleaned_withShortName.csv` are large, we have uploaded each as a separate zip archive.  
Please follow the instructions below to properly extract and use the full dataset and code:

1. **Download** all three zipped CSV files.  
2. **Unzip** them and place the resulting files inside the `Original Dataset` folder.

**Notes:**
- The file `vulCheck_v31_Cleaned.csv` was generated using the preprocessing script `vulCheck_DataPreprocessing.py`. You can regenerate it by uncommenting the save-file line in the script.
- The file `vulCheck_v31_Cleaned_withShortName.csv` was derived from `vulCheck_v31_Cleaned.csv` by manually reviewing and annotating short names for each CNA.

---

### ðŸ“‚ d Disagreement Metric

Computes the overall disagreement between CNA and NVD CVSS vector assignments using the Hamming distance.

- `hamming_distance.py`: Calculates Hamming distance between each CNA and NVD vector.
- `Hamming_Distance_AllCNA.csv`: Full output of pairwise Hamming distance results. Can be regenerated by uncommenting the save instruction in `hamming_distance.py`.
- `Median_d_withShortName.csv`: Median disagreement per CNA. Can be regenerated by uncommenting the save instruction in `hamming_distance.py`.

---

### ðŸ“‚ Per-Metric Disagreement Coefficient (PMDC)

Quantifies how often each CVSS base metric (e.g., AV, AC, PR) differs between CNA and NVD.

- `PMDC.py`: Calculates disagreement rates for each CVSS metric.
- `PMDC_withShortName.csv`: The output file containing per-metric disagreement coefficients per CNA. Can be regenerated by uncommenting the save instruction in `PMDC.py`.

---

### ðŸ“‚ Odds Ratio

Analyzes consistency at the group level using odds ratio based on identical CVE descriptions.

- `odds_ratio.py`: Assigns consistency/inconsistency labels to grouped entries and computes odds ratios.
- `group_labels_withShortName.csv`: Script-generated labels for group-level consistency. Can be regenerated by uncommenting the save instruction in `dds_ratio.py`.
- `odds_ratio_withShortName.csv`: Final odds ratio results per CNA. Can be regenerated by uncommenting the save instruction in `dds_ratio.py`.

---

### ðŸ“‚ Entropy

Measures internal consistency for each CNA and the NVD based on Shannon entropy.

- `entropy.py`: Calculates entropy over CVSS vectors grouped by identical descriptions.
- `entropy_withShortName.csv`: Entropy results per CNA and NVD. Can be regenerated by uncommenting the save instruction in `entropy.py`.

---

### ðŸ“‚ Regression Analysis

Performs statistical modeling to identify factors that influence CNAâ€“NVD disagreements.

- `logistic_regression.py`: Logistic regression model to predict whether a CNA disagrees with NVD.
- `linear_regression.py`: Linear regression model to explain the magnitude of base score differences.
- `merged_withVendor_info.csv`: This file combines the feature dataset from previous runs with manually annotated CNA organizational types. It also includes additional information such as severity level comparisons, severity differences, indicators of which party assigned a higher score, and whether a score is critical. These features may be useful for our future studies.

---

